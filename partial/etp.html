<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading nav navbar-default">
                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a data-toggle="tab" href="/#gestion"> Gestión</a>
                        </li>
                        <li>
                            <a data-toggle="tab" href="/#registros"> Registros / Auditoria</a>
                        </li>
                    </ul>
                </div>
                <div class="tab-content">
                    <div id="gestion" class="tab-pane fade in active">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="table">
                                    <br>
                                    <ul class="nav navbar-nav pull-left">
                                        <li>
                                            &nbsp;
                                            &nbsp;
                                            <b>Gestión ETP</b> <span class="badge badge-default">{{Items}}</span>
                                        </li>
                                        <li>
                                            &nbsp;
                                            &nbsp;
                                            <div data-ng-if="loading">
                                                <img title="Esperando respuesta" tooltip data-placement="top" src="img/loader.gif"/>
                                            </div>
                                        </li>
                                        <li>
                                            &nbsp;
                                            &nbsp;
                                            <button type="button" class="btn btn-default btn-xs" ng-click="recargaPageGestion()" title="Actualizar"
                                                    data-toggle="tooltip" data-placement="top" ng-disabled="loading">
                                                <i class="fa fa-refresh" aria-hidden="true"></i>
                                            </button>
                                        </li>
                                        &nbsp;
                                    </ul>
                                    <br><br>
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-hover table-condensed small">
                                            <thead class="table-header">
                                            <tr>
                                                <th class="text-center" rowspan="2"><span>Mar.</span></th>
                                                <th class="text-center" rowspan="2"><span>Login</span></th>
                                                <th class="text-center" rowspan="2"><span>Tarea</span></th>
                                                <th class="text-center" rowspan="2"><span>Arpón</span></th>
                                                <th class="text-center" rowspan="2"><span>Nap</span></th>
                                                <th class="text-center" rowspan="2"><span>Hilo</span></th>
                                                <th class="text-center" colspan="4"><span>Internet</span></th>
                                                <th class="text-center" colspan="4"><span>Televisión</span></th>
                                                <th class="text-center" rowspan="2"><span>Número Contacto</span></th>
                                                <th class="text-center" rowspan="2"><span>Nombre Contacto</span></th>
                                                <th class="text-center" rowspan="2"><span>Replanteo</span></th>
                                                <th rowspan="2"><span>Ver +</span></i></th>
                                                <th class="text-center" rowspan="2"><span>Tipificación</span></th>
                                                <th class="text-center" rowspan="2"><span>Tipificación 2</span></th>
                                                <th class="text-center" rowspan="2"><span>Fecha Creación</span></th>
                                                <th class="text-center" rowspan="2"><span>Observación tec.</span></th>
                                                <th class="text-center" rowspan="2"><span>Acción</span></th>
                                            </tr>
                                            <tr>
                                                <th class="text-center">1</th>
                                                <th class="text-center">2</th>
                                                <th class="text-center">3</th>
                                                <th class="text-center">4</th>
                                                <th class="text-center">1</th>
                                                <th class="text-center">2</th>
                                                <th class="text-center">3</th>
                                                <th class="text-center">4</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in datos">
                                                <td>
                                                    <div ng-show="data.id_soporte">
                                                        <input type="checkbox" ng-model="data.bloqueo"
                                                               name="bloqueo" id="bloqueo"
                                                               ng-click="marcarEngestion(data)"
                                                               ng-checked="data.status_soporte == 1">
                                                        <div class="loadingio-spinner-ellipsis-3nun7cb96ao" ng-show="data.bloqueo == 1">
                                                            <div class="ldio-pettsxrv7wj">
                                                                <div></div>
                                                                <div></div>
                                                                <div></div>
                                                                <div></div>
                                                                <div></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <span class="label label-primary label-xsmall" ng-if="data.login_gestion == galletainfo.login">{{data.login_gestion}}</span>
                                                    <span class="label label-primary label-xsmall" ng-if="data.login_gestion != galletainfo.login">{{data.login_gestion}}</span>
                                                </td>
                                                <!-- En estas lineas se oculta el login gestión -->
                                                <!-- <td ng-show="data.login_gestion === galletainfo.login">
                           <span ng-class="{'label label-primary label-xsmall': data.status_soporte === '2', 'label label-primary label-xsmall': data.login_gestion == galletainfo.login}">{{data.login_gestion}}</span>
                                                 </td>-->

                                                <!--<td ng-show="data.login != galletainfo.login && data.status_soporte === '2'">
                          <span
                                  ng-class="{'label label-primary label-xsmall': data.status_soporte === '2', 'label label-primary label-xsmall': data.login_gestion != galletainfo.login}">{{data.login_gestion}}</span>
                                                </td>-->

                                                <!--<td ng-show="data.login_gestion != galletainfo.login && data.status_soporte == '0'">
                                                    <span ng-class="{'label label-primary label-xsmall': data.status_soporte == '0'}"></span>
                                                </td>-->
                                                <!-- Fin ocultar el login gestión -->
                                                <td>{{data.tarea}}</td>
                                                <td>{{data.arpon}}</td>
                                                <td>{{data.nap}}</td>
                                                <td>{{data.hilo}}</td>
                                                <td>
                                                    <span ng-if="data.port_internet_1 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td><span ng-if="data.port_internet_2 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td>
                                                    <span ng-if="data.port_internet_3 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td>
                                                    <span ng-if="data.port_internet_4 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td>
                                                    <span ng-if="data.port_television_1 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td>
                                                    <span ng-if="data.port_television_2 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td>
                                                    <span ng-if="data.port_television_3 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td>
                                                    <span ng-if="data.port_television_4 == '1'">X</span>
                                                    <span ng-else></span>
                                                </td>
                                                <td>{{data.numero_contacto}}</td>
                                                <td>{{data.nombre_contacto}}</td>
                                                <td>{{data.replanteo}}</td>
                                                <td style="display: flex;justify-content: center;">
                                                    <button popover-placement="left" ng-click="ver_masss(data)" uib-popover-html="dataContent"
                                                            popover-title="Ver mas" type="button" class="btn btn-default btn-xs" tooltip-placement="top"
                                                            uib-tooltip="Ver mas">
                                                        <i class="fa fa-plus" aria-hidden="true"></i>
                                                    </button>
                                                </td>
                                                <td class="text-center">
                                                    <select ng-model="data.tipificaciones" class="btn btn-default btn-xs grupo-select" multiple
                                                            ui-select2="groupSetup" name="tipificaciones" id="tipificaciones{{data.id_soporte}}">
                                                        <option value="">Seleccionar</option>
                                                        <option value="Actualizar Infra">Actualizar Infra</option>
                                                        <option value="Configurar VLAN">Configurar VLAN</option>
                                                        <option value="Aprovisionar">Aprovisionar</option>
                                                        <option value="Cambio equipo">Cambio equipo</option>
                                                        <option value="Contingencia">Contingencia</option>
                                                        <option value="Red ocupada">Red ocupada</option>
                                                        <option value="Puertos Lan">Puertos Lan</option>
                                                        <option value="Validación general">Validación general</option>
                                                        <option value="Nap Trocado">Nap Trocado</option>
                                                        <option value="Reenvió Registros">Reenvió Registros</option>
                                                        <option value="IP navegación">IP navegación</option>
                                                        <option value="Pendiente por cobertura">Pendiente por cobertura</option>
                                                        <option value="Solicitud innecesaria">Solicitud innecesaria</option>
                                                        <option value="Configurar WIFI">Configurar WIFI</option>
                                                        <option value="Código de incompleto">Código de completo</option>
                                                        <option value="Código incompleto">Código de incompleto</option>
                                                        <option value="Código de geocerca">Código de geocerca</option>
                                                        <option value="Cierre con llamada">Cierre con llamada</option>
                                                        <option value="Soporte técnico">Soporte técnico</option>
                                                    </select>
                                                </td>

                                                <td>
                                                    <select ng-model="data.tipificaciones2" class="btn btn-default btn-xs grupo-select"
                                                            name="tipificaciones2" id="tipificacion{{data.id_soporte}}" style="width:100px">
                                                        <option value="">Seleccionar</option>
                                                        <option value="Finalizado">Finalizado</option>
                                                        <option value="Incompleto">Incompleto</option>
                                                        <option value="Devuelto al técnico">Devuelto al técnico</option>
                                                    </select>
                                                </td>
                                                <td>{{data.fecha_crea}}</td>
                                                <td class="text-center">
                                                    <button popover-placement="left" uib-popover="{{data.observacion_terreno}}"
                                                            tooltip-placement="top" uib-tooltip="Observación técnico" type="button" class="btn btn-default btn-xs">
                                                        <i class="fa fa-commenting" aria-hidden="true"></i>
                                                    </button>
                                                    <!-- <button type="button" class="btn btn-default btn-xs" title="Observación técnico" ng-click="ver_mas(data.observacion)">
                                                      <i class="fa fa-commenting" aria-hidden="true"></i>
                                                    </button> -->
                                                </td>
                                                <td>
                                                    <button type="button" class="btn btn-default btn-xs" tooltip-placement="top"
                                                            uib-tooltip="Guardar" ng-click="GuardarETP(data)">
                                                        <i class="fa fa-edit" aria-hidden="true"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MODULO DE REGISTROS -->
                    <div id="registros" class="tab-pane fade">
                        <div class="row">
                            <div class="col-sm-12">
                                <br>
                                <ul class="nav navbar-nav pull-left">
                                    &nbsp;
                                    <li>
                                        &nbsp;
                                        &nbsp;
                                        <b>Registros ETP</b> <span class="badge badge-default">{{totalItems}}</span>
                                    </li>
                                    <li>
                                        <div data-ng-if="loading">
                                            <img title="Esperando respuesta" tooltip data-placement="top" src="img/loader.gif"/>
                                        </div>
                                    </li>
                                    <li>
                                        &nbsp;
                                        <input style="width: 130px" type="text" name="fechaini" id="fechaini"
                                               class="btn btn-default btn-xs ng-pristine ng-valid ng-touched" ng-model="ETP.fechaini"
                                               placeholder="Fecha Inicial" datetime-picker="" date-only date-format="yyyy-MM-dd"
                                               autocomplete="off"/>
                                        <i class="fa fa-calendar fa-fw"></i>
                                        <input style="width: 130px" type="text" name="fechafin" id="fechafin"
                                               class="btn btn-default btn-xs ng-pristine ng-valid ng-touched" ng-model="ETP.fechafin"
                                               placeholder="Fecha Final" datetime-picker="" date-only date-format="yyyy-MM-dd"
                                               autocomplete="off"/>
                                        <i class="fa fa-calendar fa-fw"></i>

                                        <button type="button" class="btn btn-default btn-xs" ng-click="registrosETP(ETP)"
                                                ng-disabled="loading">
                                            <i class="fa fa-search-plus" aria-hidden="true"></i>
                                        </button>

                                        <button type="button" class="btn btn-success btn-xs" title="Exportar Registros"
                                                ng-click="csvETP(ETP)" ng-disabled="loading" title="Exportar" tooltip data-placement="top">
                                            <i class="fa fa-cloud-download" aria-hidden="true"> </i>
                                        </button>

                                        <b>
                                            <input type="text" name="pedido" id="pedido" class="btn btn-default btn-xs" ng-model="ETP.pedido"
                                                   placeholder="Buscar pedido" autocomplete="off"/>&nbsp;

                                            <button type="button" class="btn btn-default btn-xs" ng-click="detallePedido(ETP)"
                                                    title="Buscar" data-toggle="tooltip" data-placement="left" ng-disabled="loading">
                                                <i class="fa fa-search" aria-hidden="true"></i>
                                            </button>
                                        </b>&nbsp;
                                    </li>
                                    <li>
                                        <button type="button" class="btn btn-default btn-xs" ng-click="recargaPage()" title="Actualizar"
                                                data-toggle="tooltip" data-placement="top" ng-disabled="loading">
                                            <i class="fa fa-refresh" aria-hidden="true"></i>
                                        </button>
                                    </li>
                                    &nbsp;
                                </ul>
                                <br>
                                <br>
                                <div class="table-responsive">
                                    <table class="table table-bordered small">
                                        <thead class="table-header">
                                        <tr>
                                            <th>Login</th>
                                            <th>Pedido</th>
                                            <th>Tarea</th>
                                            <th>Region</th>
                                            <th>Hora ingreso</th>
                                            <th>Hora marca</th>
                                            <th>Hora gestión</th>
                                            <th>Tipificación 1</th>
                                            <th>Tipificación 2</th>
                                            <th class="text-center" rowspan="2"><span>Replanteo</span></th>
                                            <th>Obs. tec.</th>
                                            <th>Obs. Asesor</th>
                                            <th><span>Ver +</span></i></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="data in datosTerminados">
                                            <td>{{data.login_gestion}}</td>
                                            <td>
                                                <button type="button" class="btn btn-default btn-xs"
                                                        ng-click="CopyPortaPapeles(data.unepedido)" tooltip-placement="top"
                                                        uib-tooltip="Copiar pedido" id=p{{$index}}>{{data.unepedido}}
                                                </button>
                                            </td>
                                            <td>{{data.tarea}}</td>
                                            <td>{{data.unemunicipio}}</td>
                                            <td>{{data.fecha_crea}}</td>
                                            <td>{{data.fecha_marca}}</td>
                                            <td>{{data.fecha_gestion}}</td>
                                            <td>{{data.tipificaciones}}</td>
                                            <td>{{data.tipificaciones2}}</td>
                                            <td>{{data.replanteo}}</td>
                                            <td class="text-center">
                                                <button popover-placement="left" uib-popover="{{data.observacion_terreno}}"
                                                        tooltip-placement="top" uib-tooltip="Observación técnico" type="button" class="btn btn-default btn-xs">
                                                    <i class="fa fa-commenting" aria-hidden="true"></i>
                                                </button>
                                            </td>
                                            <td class="text-center">
                                                <button popover-placement="left" uib-popover="{{data.observacionesGestion}}"
                                                        tooltip-placement="top" uib-tooltip="Observación asesor" type="button" class="btn btn-default btn-xs">
                                                    <i class="fa fa-commenting" aria-hidden="true"></i>
                                                </button>
                                            </td>
                                            <td>
                                                <button popover-placement="left" ng-click="ver_mas2(data)" uib-popover-html="dataContent"
                                                        popover-title="Ver mas" type="button" class="btn btn-default btn-xs" tooltip-placement="top"
                                                        uib-tooltip="Ver mas">
                                                    <i class="fa fa-plus" aria-hidden="true"></i>
                                                </button>
                                            </td>

                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="text-center">
                                    <ul uib-pagination class="pagination-sm" total-items="totalItems" ng-model="currentPage"
                                        ng-change="pageChanged()" items-per-page="pageSize" max-size="5" boundary-links="true" rotate="true"
                                        previous-text="&#8672;" next-text="&#8674;" first-text="Primero" last-text="Último"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br><br><br>
